import{_ as n,p as a,q as s,a1 as t}from"./framework-efe98465.js";const e={},p=t(`<h1 id="attachments" tabindex="-1"><a class="header-anchor" href="#attachments" aria-hidden="true">#</a> Attachments</h1><p>When you wish to attach a file to an issue, you must first upload it to Redmine, so that an attachment token can be obtained.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Aedart<span class="token punctuation">\\</span>Redmine<span class="token punctuation">\\</span>Attachment</span><span class="token punctuation">;</span>

<span class="token comment">// Upload file, obtain attachment&#39;s token</span>
<span class="token variable">$attachment</span> <span class="token operator">=</span> <span class="token class-name static-context">Attachment</span><span class="token operator">::</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/path/to/file.pdf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="create-issue-with-attachment" tabindex="-1"><a class="header-anchor" href="#create-issue-with-attachment" aria-hidden="true">#</a> Create issue with attachment</h2><p>Later, you can then choose to create a new issue with the uploaded attachment (<em>associates attachment with issue, in Redmine</em>). The <code>createWithAttachments()</code> accepts an array of attachments.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Aedart<span class="token punctuation">\\</span>Redmine<span class="token punctuation">\\</span>Issue</span><span class="token punctuation">;</span>

<span class="token variable">$attachments</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token variable">$attachmentA</span><span class="token punctuation">,</span>
    <span class="token variable">$attachmentB</span><span class="token punctuation">,</span>
    <span class="token variable">$attachmentC</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$issue</span> <span class="token operator">=</span> <span class="token class-name static-context">Issue</span><span class="token operator">::</span><span class="token function">createWithAttachments</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;project_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;status_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;tracker_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;subject&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Working procedures&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$attachments</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="add-attachments-to-existing-issue" tabindex="-1"><a class="header-anchor" href="#add-attachments-to-existing-issue" aria-hidden="true">#</a> Add attachments to existing issue</h2><p>You may also associate an attachment with an existing issue</p><p><strong>Note</strong>: <em>The attachment MUST have a token set, or Redmine will NOT perform as desired.</em></p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$issue</span>
    <span class="token operator">-&gt;</span><span class="token function">withAttachment</span><span class="token punctuation">(</span><span class="token variable">$attachment</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...or multiple attachments</span>

<span class="token variable">$issue</span>
    <span class="token operator">-&gt;</span><span class="token function">withAttachments</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token variable">$attachmentA</span><span class="token punctuation">,</span>
        <span class="token variable">$attachmentB</span><span class="token punctuation">,</span>
        <span class="token variable">$attachmentC</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="download-associated-attachments" tabindex="-1"><a class="header-anchor" href="#download-associated-attachments" aria-hidden="true">#</a> Download associated attachments</h2><p>The <code>Issue</code> resource also allows you to obtain associated attachments, which you can download.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$attachments</span> <span class="token operator">=</span> <span class="token class-name static-context">Issue</span><span class="token operator">::</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;attachments&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token property">attachments</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$attachments</span> <span class="token keyword">as</span> <span class="token variable">$attachment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$attachment</span><span class="token operator">-&gt;</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/dir/where/to/download&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),c=[p];function i(o,l){return a(),s("div",null,c)}const r=n(e,[["render",i],["__file","attachments.html.vue"]]);export{r as default};
