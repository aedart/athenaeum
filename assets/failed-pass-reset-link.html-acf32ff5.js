import{_ as i,M as t,p as r,q as c,R as s,t as e,N as n,U as l,a1 as p}from"./framework-efe98465.js";const d={},u=s("h1",{id:"failed-password-reset-link-api-response",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#failed-password-reset-link-api-response","aria-hidden":"true"},"#"),e(" Failed Password Reset Link (API Response)")],-1),k={href:"https://laravel.com/docs/12.x/fortify#requesting-a-password-reset-link",target:"_blank",rel:"noopener noreferrer"},h={href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#successful_responses",target:"_blank",rel:"noopener noreferrer"},v={class:"custom-container tip"},m=s("p",{class:"custom-container-title"},"Note",-1),_=s("p",null,[e("The above described edge case scenario is "),s("strong",null,"NOT"),e(' specifically tied to Laravel Fortify. Any kind of "reset password" functionality '),s("em",null,"can be"),e(" subject to such, if end-users are able to request a reset password link.")],-1),f={href:"https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account.html",target:"_blank",rel:"noopener noreferrer"},b=s("code",null,"FailedPasswordResetLinkApiResponse",-1),g={href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200",target:"_blank",rel:"noopener noreferrer"},w=p(`<div class="custom-container warning"><p class="custom-container-title">Limitations</p><p>The <code>FailedPasswordResetLinkApiResponse</code> is intended for API driven login mechanisms, e.g. when your &quot;request reset password&quot; functionality is implemented via a JSON based API.</p></div><h2 id="how-to-use" tabindex="-1"><a class="header-anchor" href="#how-to-use" aria-hidden="true">#</a> How to use</h2><p>To use the custom API response, register a singleton binding for the <code>FailedPasswordResetLinkRequestResponse</code> interface.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\\</span>Providers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Aedart<span class="token punctuation">\\</span>Auth<span class="token punctuation">\\</span>Fortify<span class="token punctuation">\\</span>Responses<span class="token punctuation">\\</span>FailedPasswordResetLinkApiResponse</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Foundation<span class="token punctuation">\\</span>Support<span class="token punctuation">\\</span>Providers<span class="token punctuation">\\</span>AuthServiceProvider</span> <span class="token keyword">as</span> ServiceProvider<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\\</span>Fortify<span class="token punctuation">\\</span>Contracts<span class="token punctuation">\\</span>FailedPasswordResetLinkRequestResponse</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">AuthServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">singleton</span><span class="token punctuation">(</span>
            <span class="token class-name static-context">FailedPasswordResetLinkRequestResponse</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name static-context">FailedPasswordResetLinkApiResponse</span><span class="token operator">::</span><span class="token keyword">class</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="additional-reading" tabindex="-1"><a class="header-anchor" href="#additional-reading" aria-hidden="true">#</a> Additional Reading</h2>`,5),y={href:"https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html",target:"_blank",rel:"noopener noreferrer"},x={href:"https://www.vaadata.com/blog/exploring-password-reset-vulnerabilities-and-security-best-practices/",target:"_blank",rel:"noopener noreferrer"},P={href:"https://medium.com/@cuncis/exploring-reset-password-vulnerabilities-risks-exploits-and-prevention-strategies-87745b65dd66",target:"_blank",rel:"noopener noreferrer"};function R(A,S){const a=t("ExternalLinkIcon"),o=t("RouterLink");return r(),c("div",null,[u,s("p",null,[e("In an edge case scenario, a "),s("a",k,[e('"forgot password"'),n(a)]),e(" mechanism can potentially be misused to guess if a user account exists or not. Most commonly, this is done so by requesting a password reset, to a specified email. When your application responds with a "),s("a",h,[e("successful response"),n(a)]),e(" for a valid email, attackers will know that an account exists and proceed to exploitation attempts.")]),s("div",v,[m,_,s("p",null,[e("See "),s("a",f,[e("Testing for Account Enumeration and Guessable User Account"),n(a)]),e(" for additional details.")])]),s("p",null,[e("To reduce the chances of revealing the existence of a user account, when requesting a reset link, the "),b,e(" can be used. Whenever the requested username, e.g. email, does not exist, the component throws a "),n(o,{to:"/archive/current/auth/fortify/exceptions/pass-reset-link-failure.html"},{default:l(()=>[e('"password reset link failure"')]),_:1}),e(" exception, which results in an HTTP "),s("a",g,[e('"200 Ok"'),n(a)]),e(" response. An attacker will then no longer be able to tell the difference between a valid or invalid username.")]),w,s("ul",null,[s("li",null,[s("a",y,[e("Forgot Password Cheat Sheet"),n(a)]),e(".")]),s("li",null,[s("a",x,[e("Exploring Password Reset Vulnerabilities and Security Best Practices"),n(a)])]),s("li",null,[s("a",P,[e("Exploring Reset Password Vulnerabilities: Risks, Exploits, and Prevention Strategies"),n(a)])])])])}const T=i(d,[["render",R],["__file","failed-pass-reset-link.html.vue"]]);export{T as default};
